<!DOCTYPE html>
<html lang="ja">
    <head>
        <meta charset="UTF-8">
        <title>Linuxコマンドの使い方【上級編】</title>
        <meta name="description" content="Linuxコマンドの使い方【上級編】">
        <meta name="viewport" content="width=device-width,initial-scale=1">

    <!-- CSS -->
        <link rel="stylesheet" href="https://unpkg.com/ress@3.0.0/dist/ress.min.css">
        <link rel="stylesheet" href="../css/style.css">
    <!-- JQuery -->
    <script src="https://code.jquery.com/jquery-3.2.1.js" integrity="sha256-DZAnKJ/6XZ9si04Hgrsxu/8s717jcIzLy3oi35EouyE=" crossorigin="anonymous"></script>
    <script src="../js/menu.js" type="text/javascript"></script>
    <script src="../js/footer.js" type="text/javascript"></script>
    </head>

<body>
    <div class="page-contents">
        <!-- Accordion Menu -->
        <script type="text/javascript">loadMenu('../');</script>
        <!-- MAIN CONTENTS -->
        <div class="main-contents">
            <!-- HEADER IMAGE -->
            <div id="linux-bg" class="big-bg">
                <div class="title-contents wrapper">
                    <h2 class="page-title">Linux</h2>
                </div>
            </div>

            <!-- CONTENTS -->
            <div class="main-text wrapper">
                <div class="hierarchie">
                    <a href="../index.html"><img class="home-icon" src="../images/logo_original.png" alt="home"></a>
                    <p> ＞ <a href="linux_command_top.html">Linixコマンド</a> ＞ Linuxコマンド【上級編】</p>
                </div>
                <div>
                    <h2 class="content-title">Linuxコマンド【上級編】</h2>
                    <p>
                        Linuxコマンド上級編は、主にPCスペックの確認やハードディスクに関するものをまとめた。
                        普段の研究では使用しないだろうが、PCのメンテナンス時には便利なものが多いと思う。
                    </p>
                    <table>
                        <tr>
                            <th>コマンド</th>
                            <th>説明</th>
                        </tr>
                        <tr>
                            <td>lscpu</td>
                            <td>CPUの情報を表示</td>
                        </tr>
                        <tr>
                            <td></td>
                            <td>ファイルの末尾を表示</td>
                        </tr>
                        <tr>
                            <td>grep</td>
                            <td>指定した文字列がファイル内に存在する場合、その行を抽出</td>
                        </tr>
                        <tr>
                            <td>awk</td>
                            <td>テキストの加工とパターン処理</td>
                        </tr>
                        <tr>
                            <td>sed</td>
                            <td>文字や文字列を変換</td>
                        </tr>
                        <tr>
                            <td>ln</td>
                            <td>ファイルやディレクトリにリンクを設定</td>
                        </tr>
                        <tr>
                            <td>find</td>
                            <td>ファイルを検索</td>
                        </tr>
                        <tr>
                            <td>tar</td>
                            <td>アーカイブを作成または復元</td>
                        </tr>
                    </table>
                    <p>
                        ここまでのコマンドが使えるのであれば、Linuxでほとんどの作業ができるであろう。
                        <a href="./linux_command3.html">Linuxコマンド【上級編】</a>では筆者の備忘録も兼ねて、さらにいくつかのコマンド（システム関係）を紹介している。
                    </p>
                </div>

                <div class="content-block">
                    <h3>lscpu</h3>
                    <p>
                        <code>lscpu</code>はCPUの情報を表示するコマンドである。
                        CPUの種類やコア数などを確認できる。
                        <code>cat /proc/cpuinfo</code>でも同様の操作が可能。
                    </p>

<pre><code>[user@local ~]$ cat data.dat
function data
# id    x    y
  zero  0    0
  one   1    1
  two   2    4
  three 3    9
</code></pre>

                    <p>
                        コマンドを実行すると、ファイルの中身がターミナル上に出力される。
                    </p>
                </div>

                <div class="content-block">
                    <h3>tail</h3>
                    <p>
                        <code>tail</code>はファイルの末尾を表示するコマンドである。
                        <code>tail ファイル名</code>で使用できるが、オプションを指定すると便利である。
                    </p>
                    <table>
                        <tr>
                            <th>tailオプション</th>
                            <th>説明</th>
                        </tr>
                        <tr>
                            <td>-c</td>
                            <td>最後から出力する文字数を指定する。</td>
                        </tr>
                        <tr>
                            <td>-n</td>
                            <td>最後から出力する行数を指定する。<code>n</code>は省略できる。</td>
                        </tr>
                        <tr>
                            <td>-f</td>
                            <td>ファイルへの追記をリアルタイムで監視する。</td>
                        </tr>
                    </table>
                    <p>
                        ファイルの最終行から3行を表示する場合には次のコマンドを実行する。
                    </p>

<pre><code>[user@local ~]$ tail -3 data.dat
  one   1    1
  two   2    4
  three 3    9
</code></pre>

                    <p>
                        このコマンドはログファイルのリアルタイム監視時に<code>tail -f　ログファイル名</code>で用いると便利である。
                        また似たようなコマンドに、ファイルの先頭から出力する<code>head</code>が存在する。
                    </p>
                </div>
                
                <div class="content-block">
                    <h3>grep</h3>
                    <p>
                        <code>grep</code>は指定した文字列がファイル内に存在する場合、その行を抽出するコマンドである。
                        基本的には<code>grep 文字列 ファイル名</code>として使用する。
                        便利なオプションも多いので表にまとめておく。
                    </p>
                    <table>
                        <tr>
                            <th>grepオプション</th>
                            <th>説明</th>
                        </tr>
                        <tr>
                            <td>-v</td>
                            <td>指定した文字列を含まない行を抽出する。</td>
                        </tr>
                        <tr>
                            <td>-n</td>
                            <td>抽出結果に行番号を表示する。</td>
                        </tr>
                        <tr>
                            <td>-c</td>
                            <td>指定した文字列を含む行の数を表示する。</td>
                        </tr>
                        <tr>
                            <td>-i</td>
                            <td>大文字・小文字を区別せずに抽出する。</td>
                        </tr>
                        <tr>
                            <td>-e</td>
                            <td>拡張正規表現で抽出を行う。実際には複数条件（OR）での抽出に使用する。</td>
                        </tr>
                    </table>

<pre><code>[user@local ~]$ grep one data.dat
  one   1    1
[user@local ~]$ grep -ve zero -ve one data.dat
function data
# id    x    y
  two   2    4
  three 3    9
</code></pre>

                    <p>
                        2つ目の例では文字列「zero」または「one」が含まれる行以外を抽出している。
                        <code>grep</code>はデータ加工に非常に便利であり、出力結果をリダイレクトして活用することが多い。
                    </p>
                </div>

                <div class="content-block">
                    <h3>awk</h3>
                    <p>
                        <code>awk</code>はテキストの加工とパターン処理を行うコマンドである。
                        と言われても釈然としないが、<code>awk</code>には本当にたくさんの使用方法がある。
                        ここでは<code>grep</code>と組み合わせたデータ抽出の例を取り上げる。
                        <br><br>
                        一般的に<code>awk</code>は<code>awk (パターン) {アクション}</code>の形で使用する。
                        <code>grep</code>と組み合わせる場合は<code>grep ファイル名 | awk '{print 出力したい部分}'</code>とすることで、必要な数値のみを抽出できる。
                        例えば、data.dat内の「two」の行の「4」という数字がほしい場合は以下のコマンドを実行する。
                    </p>
                   
<pre><code>[user@local ~]$ grep two data.dat | awk '{print $3}'
4
</code></pre>

                    <p>
                        この例では<code>grep</code>で「two」を含む行を抽出した後、<code>awk</code>により空白区切りで3番目の文字列を出力するようにしている。
                        書式は例を参考にしてそのまま覚えてほしい。
                        なお、2つのコマンドを繋ぐ「|」の記号は<strong>パイプ</strong>と呼ばれており、左側の処理結果を右のコマンドに受け渡す役割を担っている。
                        パイプの使用例としては<code>ls</code>で表示した内容のうち、<code>grep</code>で指定したものだけを取り出す場合などがある。
                    </p>

<pre><code>[user@local ~]$ ls
data.dat    submit1.sh    submit2.sh    plot.py    analysis.py
[user@local ~]$ ls | grep py
plot.py
analysis.py
</code></pre>
                
                </div>

                <div class="content-block">
                    <h3>sed</h3>
                    <p>
                        <code>sed</code>は文字や文字列を変換するコマンドである。
                        このコマンドの使用方法も様々であるので、ここではファイル文字列の置換処理と行削除の例を扱う。
                    </p>
                    <h4>sed -e 's/xxx/XXX/g' ファイル名</h4>
                    <p>
                        あるファイル内の「xxx」という文字列全てを「XXX」に置換して出力する場合に使用する。
                        さらに<code>-i</code>オプションをつけることでファイルの直接置換を行うことも可能。
                    </p>
                   
<pre><code>[user@local ~]$ sed -e 's/1/-1/g' data.dat
function data
# id    x    y
  zero  0    0
  one   -1    -1
  two   2    4
  three 3    9
[user@local ~]$ sed -i -e 's/function/incorrect/g' data.dat
[user@local ~]$ cat data.dat | head -1
incorrect data
</code></pre>
                    <p>
                        ファイル名の部分には複数ファイルを指定することもできる。
                        なお、<code>s</code>は正規表現で置換処理をする、<code>g</code>は全てのマッチした文字列を置換するという意味を持っている。
                    </p>
                    <h4>sed (行数)d</h4>
                    <p>
                        <code>sed</code>の<code>d</code>は行削除を行うコマンドである。
                        単純に<code>sed d</code>とすると全ての行が削除されてしまうので、基本は行数を同時に指定して削除を行う。
                    </p>

<pre><code>[user@local ~]$ sed 1d data.dat
# id    x    y
  zero  0    0
  one   1    1
  two   2    4
  three 3    9
[user@local ~]$ sed 2,4d data.dat
incorrect data
  two   2    4
  three 3    9
</code></pre>

                    <p>
                        1つ目の例はファイルの1行目を、2つ目の例はファイルの2行目から4行目までを削除したものである。
                    </p>
                </div>

                <div class="content-block">
                    <h3>ln</h3>
                    <p>
                        <code>ln</code>はファイルやディレクトリにリンクを設定するコマンドである。
                        リンクにはハードリンクとシンボリックリンクがあり、
                    </p>
                </div>
                
                <div class="hierarchie-bottom">
                    <a href="./linux_command1.html">PREVIOUS</a>
                    <a href="./linux_command_top.html">TOP</a>
                    <a href="./linux_command3.html">NEXT</a>
                </div>

            </div>
            <script type="text/javascript">loadFooter();</script>
        </div>
    </div>
</body>
</html>